{% extends '@Forumify/frontend/base.html.twig' %}
{% block title_page %}{{ 'milhq.opcenter.operations_center'|trans }}{% endblock %}
{% block body %}
    <div class="flex justify-between mb-4">
        {% include '@ForumifyMilhqPlugin/frontend/soldier/components/header.html.twig' %}
        <div class="flex items-center justify-end flex-wrap gap-2">
            {% block opcenter_actions %}
                <a class="btn-primary" href="{{ path('milhq_soldier', { id: soldier.id }) }}">
                    {{ 'milhq.opcenter.pfile'|trans }}
                </a>
                {% if milsimUnitsId is not empty %}
                    <iframe
                        height="40"
                        width="220"
                        src="https://milsimunits.com/embed/{{ milsimUnitsId }}"
                        frameborder="0"
                    ></iframe>
                {% endif %}
            {% endblock %}
        </div>
    </div>
    {% block opcenter_announcements %}
        {% if announcement %}
            <div class="mb-6 border rounded p-4">
                {% set announcementPreview = announcement|striptags(['br', 'p', 'a', 'strong']) %}
                {% if announcementPreview|length > 1000 %}
                    {{ announcementPreview|u.truncate(750, '...', false)|rich }}
                    {% embed '@Forumify/components/modal.html.twig' %}
                        {% block modalOpenButton %}
                            <button class="btn-primary">Read more</button>
                        {% endblock %}
                        {% block modalContent %}
                            <div class="card">
                                <div class="card-title">Announcement</div>
                                <div class="card-body">
                                    {{ announcement|rich }}
                                </div>
                            </div>
                        {% endblock %}
                    {% endembed %}
                {% else %}
                    {{ announcement|rich }}
                {% endif %}
            </div>
        {% endif %}
    {% endblock %}
    {% embed '@Forumify/components/tabs.html.twig' %}
        {% block tabs %}
            <button class="btn-link" data-tab-id="submissions">{{ 'milhq.opcenter.submissions'|trans }}</button>
            {% if plugin_version('forumify/forumify-milhq-plugin', 'premium') %}
                <button class="btn-link" data-tab-id="operations">{{ 'milhq.opcenter.operations'|trans }}</button>
                {% if is_granted('milhq.frontend.attendance_sheet.view') %}
                    <button class="btn-link" data-tab-id="attendance">{{ 'milhq.opcenter.attendance'|trans }}</button>
                {% endif %}
                <button class="btn-link" data-tab-id="courses">{{ 'milhq.opcenter.courses'|trans }}</button>
            {% endif %}
        {% endblock %}
        {% block tabpanels %}
            {% include '@ForumifyMilhqPlugin/frontend/operations_center/tabs/submissions.html.twig' %}
            {% if plugin_version('forumify/forumify-milhq-plugin', 'premium') %}
                {% include '@ForumifyMilhqPlugin/frontend/operations_center/tabs/operations.html.twig' %}
                {% if is_granted('milhq.frontend.attendance_sheet.view') %}
                    {% include '@ForumifyMilhqPlugin/frontend/operations_center/tabs/attendance.html.twig' %}
                {% endif %}
                {% include '@ForumifyMilhqPlugin/frontend/operations_center/tabs/courses.html.twig' %}
            {% endif %}
        {% endblock %}
    {% endembed %}
{% endblock %}
