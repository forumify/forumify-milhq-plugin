{% extends '@Forumify/admin/base.html.twig' %}
{% block body %}
    <h1>Migrate to MILHQ</h1>
    {% if results is not defined %}
        <div class="rounded border p-4">
            <p>This migration process will copy all your settings and personnel data from the forumify PERSCOM.io plugin and configure it in MILHQ.</p>
            <p>Depending on the amount of data, this process may take a minute to complete.</p>
            <div class="alert-error mb-4 mt-4">
                <p class="text-black">!!WARNING!!</p>
                <p>This migration tool will irreversably delete all MILHQ data that is present on your website. Do not use this tool if you've already been using MILHQ!</p>
            </div>
            <div class="mt-4 flex gap-2 items-center">
                <a class="btn-primary" href="{{ path('milhq_admin_migrate_perscom_migrate') }}">Start Migration</a>
                <a class="btn-link" href="{{ path('milhq_admin_configuration') }}">Cancel</a>
            </div>
        </div>
    {% else %}
        <h3>Migration Complete!</h3>
        <p class="mb-2">Please double check all of your data was migrated successfully, and then you can safely remove the PERSCOM.io integration plugin.</p>
        <p class="mb-2">If anything is missing, please let us know in the forumify Discord or forums, you can re-run this migration as many times as you want, just keep in mind that any modifications to MILHQ will be removed in the process.</p>
        <a class="btn-link mb-6" href="{{ path('milhq_admin_configuration') }}"><i class="ph ph-arrow-left"></i> Back to configuration</a>
        <h4>Migration Results</h4>
        <p class="mb-2">Took {{ took|number_format(2) }} seconds, using {{ memory|number_format(2) }} MB memory.</p>
        {% for entity, result in results %}
            <p>{{ entity|humanize }}: <span class="text-bold">{{ result.count }}</span></p>
            {% if result.messages is not empty %}
                <p>Messages:</p>
                <ul>
                    {% for message in result.messages %}
                        <li>{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endfor %}
    {% endif %}
{% endblock %}
